String.prototype.trim=function(){return this.replace(/^\s\s*/,"").replace(/\s\s*$/,"")};var str_result="";var loginbaseUrl=$("#contextPath").val();var InterValObj;var curCount=60;var waitingPost=false;$(document).ready(function(){var a=$("#pages1").val();showPromotion();isCheckCodeShow("","0");str_account=getCookie("glms_uu");if(a=="login"){if(str_account===undefined||str_account===""||str_account===null||str_account==="undefined"){$("#bodyDivID").find(".account_login").find(".userAccount").val("")}else{$("#bodyDivID").find(".account_login").find(".userAccount").val(str_account)}}$(document).find(".login_tab li a").live("click",function(d){d.preventDefault();var b=$(this).parent("li");if(b.hasClass("current")){return false}else{var c=parseInt(b.index());$("#bodyDivID").find(".login_tab li").removeClass("current");b.addClass("current");$("#bodyDivID").find(".loginPlane").hide();$("#bodyDivID").find(".loginPlane").eq(c).show()}});$("#bodyDivID").find(".regist").live("click",function(b){b.preventDefault();if($(this).hasClass("disagree")){return false}else{regist()}});$(".registLogin").find(".userAccount").live("input propertychange",function(){$(".registLogin").find(".existedTips").hide()})});function delPsw(){$("#bodyDivID").find(".setPassword").val("");$("#bodyDivID").find(".delPassWord").hide()}function showPsw(){if($("#bodyDivID").find(".eyeHide").hasClass("eyeShow")){$("#bodyDivID").find(".setPassword").prop("type","password");$("#bodyDivID").find(".eyeHide").removeClass("eyeShow")}else{$("#bodyDivID").find(".setPassword").prop("type","text");$("#bodyDivID").find(".eyeHide").addClass("eyeShow")}}function removeContent(){var a=$("#userAccount1").val();if(a==="已验证手机号/邮箱"||a==="手机号/邮箱"){$("#userAccount1").val("")}}function removePwdContent(){$("#passWordtext1").css("display","none");$("#passWord1").css("display","block");$("#passWord1").focus()}function sendMessageCode(){$("#randomTel1").click();goldlogRecord("/mei.2.17","","type=popup","H1733418");checkFormInfo("regist","no","send","","")}function isCheckCodeShow(a,b){$.ajax({url:loginbaseUrl+"/user/isCheckCodeShow?key="+a+"&pass_error="+b,type:"get",cache:false,async:false,success:function(c){$("#is_check_code_show_popup").val(c);if(c==="0"){$("#bodyDivID").find(".account_login").find(".rdm_img").addClass("hidstyle");$("#bodyDivID").find(".account_login").find(".rdm_img").removeClass("show")}else{if(c==="1"){$("#bodyDivID").find(".account_login").find(".rdm_img").addClass("show");$("#bodyDivID").find(".account_login").find(".rdm_img").removeClass("hidstyle")}}},error:function(){}})}function resetRandom(a,b){$(".rdm").attr("src",a+"/user/getRandom?"+Math.random());$(b).val("")}function checkMobile(d){var a;if(d=="login"){a=$("#bodyDivID").find(".mobileLogin")}else{a=$("#bodyDivID").find(".registLogin")}var b=$.trim(a.find(".userAccount").val());var c=/^(1)[0-9]{10}$/;if(!b){a.find(".Act_error").html("请输入手机号");return false}else{if(b.length!==11||!c.test(b)){a.find(".Act_error").html("请输入格式正确的手机号");return false}else{a.find(".Act_error").html("");return true}}}function checkRdmImg(c){var a;if(c=="login"){a=$("#bodyDivID").find(".mobileLogin")}else{a=$("#bodyDivID").find(".registLogin")}var b=$.trim(a.find(".yanzheng").val());if(!b){a.find(".Rdm_error").html("请输入图形验证码，再重新发送获取手机验证码");return false}else{a.find(".Rdm_error").html("");return true}}function checkAccountAll(e,g){if(e=="mobile"){var k;if(g=="login"){k=$("#bodyDivID").find(".mobileLogin")}else{k=$("#bodyDivID").find(".registLogin")}var a=$.trim(k.find(".userAccount").val());var h=/^(1)[0-9]{10}$/;var b=$.trim(k.find(".yanzhenma").val());var c=$.trim(k.find(".setPassword").val());if(!a){k.find(".Act_error").html("请输入手机号");return false}else{if(a.length!==11||!h.test(a)){k.find(".Act_error").html("请输入格式正确的手机号");return false}else{k.find(".Act_error").html("")}}if(k.find(".rdm_img").hasClass("show")){var i=$.trim(k.find(".yanzheng").val());if(!i){k.find(".Rdm_error").html("请输入图形验证码，再重新发送获取手机验证码");return false}else{k.find(".Rdm_error").html("")}}if(!b){k.find(".Pwd_error").html("请输入验证码");return false}else{k.find(".Pwd_error").html("")}if($("#bodyDivID").find("#pages1").val()=="regist"){if(!c){k.find(".password_error").html("6-20个字符，由字母、数字和符号的两种以上组合");return false}else{k.find(".password_error").html("")}}return true}else{var k=$("#bodyDivID").find(".account_login");var f=k.find(".userAccount").val();var j=k.find(".passWord").val();if(!f){k.find(".Act_error").html("请输入手机号/邮箱");return false}else{k.find(".Act_error").html("")}if(!j){k.find(".password_error").html("请输入密码");return false}else{k.find(".password_error").html("")}if(k.find(".rdm_img").hasClass("show")){var d=$.trim(k.find(".yanzheng").val());if(!d){k.find(".Rdm_error").html("请输入右图验证码");return false}else{k.find(".Rdm_error").html("")}}return true}}function getSMSCode(d){var a;if(d=="login"){a=$("#bodyDivID").find(".mobileLogin")}else{a=$("#bodyDivID").find(".registLogin")}if(a.find(".getSMSCode").hasClass("disable")){return false}else{if(checkMobile(d)){var c="";var b=$.trim(a.find(".userAccount").val());$.ajax({type:"get",async:false,url:loginbaseUrl+"/user/isCheckCodeShowSms",data:{key:b},success:function(e){if(e=="0"){a.find(".rdm_img").removeClass("show");a.find(".rdm_img").addClass("hide");toSMSAjax(b,c,a)}else{a.find(".rdm_img").removeClass("hide");a.find(".rdm_img").addClass("show");if(checkRdmImg(d)){c=$.trim(a.find(".yanzheng").val());toSMSAjax(b,c,a)}}},error:function(){}})}}}function toSMSAjax(c,d,a){var b=$("#randomTelCheckCode").val();$.ajax({type:"post",async:false,url:loginbaseUrl+"/user/sendValidateCodeNew",data:{telphone:c,randomTelCheckCode:b,imageValidationCode:d},success:function(f){$("#randomTelCheckCode").val(f.randomTelCheckCode);var e=f.result;var g=f.isShowPrivacyAgree;if(e=="success"){InterValObj=window.setInterval(function(){setRemainTime(a)},1000)}if(e=="telEmpty"){a.find(".Act_error").html("请输入手机号");setTimeout(function(){a.find(".Act_error").html("")},3000);a.find(".rdm_imgBox").click()}if(e=="needImgCode"){a.find(".Rdm_error").html("请输入图形验证码，再重新发送获取手机验证码");setTimeout(function(){a.find(".Rdm_error").html("")},3000);a.find(".rdm_imgBox").click()}if(e=="wrongImgCode"){a.find(".Rdm_error").html("图形验证码错误，请重新填写");setTimeout(function(){a.find(".Rdm_error").html("")},3000);a.find(".rdm_imgBox").click()}if(e=="timeLimit"){a.find(".Pwd_error").html("系统繁忙，请稍后点击");setTimeout(function(){a.find(".Pwd_error").html("")},3000);a.find(".rdm_imgBox").click()}if(e=="nosend"){a.find(".Pwd_error").html("获取验证码失败");setTimeout(function(){a.find(".Pwd_error").html("")},3000);a.find(".rdm_imgBox").click()}if(g=="1"){a.find(".agreeBox").show();a.find("#mobileLogin").addClass("disagree")}else{a.find(".agreeBox").hide();a.find("#mobileLogin").removeClass("disagree")}},error:function(){}})}function setRemainTime(a){if(curCount==0){window.clearInterval(InterValObj);a.find(".getSMSCode").text("重新发送");curCount=60;a.find(".getSMSCode").removeClass("disable");a.find(".getSMSCode").addClass("rsendRandm")}else{curCount--;a.find(".getSMSCode").text(curCount+"秒");a.find(".getSMSCode").addClass("disable");a.find(".getSMSCode").removeClass("rsendRandm")}}function passwordStrength(b){chkPassWord(b,"regist");if(b.length>0){$("#bodyDivID").find("#lowMHight").removeClass("hidstyle");$("#bodyDivID").find("#lowMHight").addClass("showstyle");$(".delPassWord").show()}else{$("#bodyDivID").find("#lowMHight").addClass("hidstyle");$("#bodyDivID").find("#lowMHight").removeClass("showstyle");$(".delPassWord").hide()}var a=checkStrong(b);switch(a){case 0:if(b.length===6){$("#bodyDivID").find("#lowPwd").text("密码较弱，建议设置多种字符组成的复杂密码")}$("#bodyDivID").find("#lowMHight span").css("background-color","#D1D0CE");$("#bodyDivID").find("#low").css("background-color","#EC3C3C");break;case 1:$("#bodyDivID").find("#lowPwd").text("");$("#bodyDivID").find("#lowMHight span").css("background-color","#D1D0CE");$("#bodyDivID").find("#middle").css("background-color","#F7BD5B");break;case 2:$("#bodyDivID").find("#lowPwd").text("");$("#bodyDivID").find("#lowMHight span").css("background-color","#D1D0CE");$("#bodyDivID").find("#height").css("background-color","#7FCF3E");break;default:$("#bodyDivID").find("#lowPwd").text("");$("#bodyDivID").find("#lowMHight span").css("background-color","#D1D0CE");$("#bodyDivID").find("#height").css("background-color","#7FCF3E");break}return}function chkPassWord(a){if(a===""||a===null){$("#bodyDivID").find(".password_error").text("6-20个字符，由字母、数字和符号的两种以上组合");$("#bodyDivID").find("#lowPwd").text("");return false}else{if(a.length<6){$("#bodyDivID").find(".password_error").text("密码长度不能少于6位");$("#bodyDivID").find("#lowPwd").text("");return false}else{$("#bodyDivID").find(".password_error").text("")}}return true}function isAgreend(a){if($(a).hasClass("not_selected")){$(a).addClass("selected");$(a).removeClass("not_selected");$("#isAgreend").val(1);$(a).parents("#bodyDivID").find(".regist").removeClass("disagree")}else{$(a).addClass("not_selected");$(a).removeClass("selected");$("#isAgreend").val(0);$(a).parents("#bodyDivID").find(".regist").addClass("disagree")}}function isAgreend2(a){if($(a).hasClass("not_selected")){$(a).addClass("selected");$(a).removeClass("not_selected");$(a).parents("#bodyDivID").find("#mobileLogin").removeClass("disagree")}else{$(a).addClass("not_selected");$(a).removeClass("selected");$(a).parents("#bodyDivID").find("#mobileLogin").addClass("disagree")}}function isRemenber(a){if($(a).hasClass("not_selected")){$(a).addClass("selected");$(a).removeClass("not_selected");$("#isRemenbered").val("yes")}else{$(a).addClass("not_selected");$(a).removeClass("selected");$("#isRemenbered").val("no")}}function regist(){var e="mobile";var d="regist";var f=$("#bodyDivID").find(".registLogin").find(".userAccount").val();var g=$("#bodyDivID").find(".registLogin").find(".yanzhenma").val();var h=$("#bodyDivID").find(".setPassword").val();var b=encodeURIComponent(getCookie("__utmz"));var c=getCookie("pid");if(c==null||c==undefined||c==""){c=""}var a=getCookie("clk1");if(a==null||a==undefined||a==""){a=""}var i=encodeURIComponent('{"pid":"'+c+'","clk1":"'+a+'"}');if(checkAccountAll(e,d)){toEncrypt(h);var j=$("#encryptPwd").val();if(waitingPost){return false}waitingPost=true;$.ajax({type:"post",async:false,url:loginbaseUrl+"/user/toSmsRegist",data:{telphone:f,validationCode:g,password:j,utmz:b,followJsonStr:i},success:function(l){var k=l.result;if(k==="success"){Setcookie("glms_uu",f);Setcookie("glms_new",true);_closeDialog();var m=l.callBackUrl;if(""!==m){window.location.href=base64decode(m)}else{window.location.href=loginbaseUrl+"/index.html"}goldlogRecord("/mei.2.11","","type=page","H1733391")}if(k=="wrongRegist"){$(".registLogin").find(".errorInfo").html("注册失败");setTimeout(function(){$(".registLogin").find(".errorInfo").html("")},3000)}if(k=="ipLimitCount"){$(".registLogin").find(".errorInfo").html("IP超限，请明天再注册");setTimeout(function(){$(".registLogin").find(".errorInfo").html("")},3000)}if(k=="noIdenticalMobile"){$(".registLogin").find(".errorInfo").html("手机号与验证码不匹配！");setTimeout(function(){$(".registLogin").find(".errorInfo").html("")},3000)}if(k=="wrongValiatedCode"){$(".registLogin").find(".Pwd_error").html("验证码错误，请重新输入");setTimeout(function(){$(".registLogin").find(".Pwd_error").html("")},3000)}if(k=="isExistedAccount"){$(".registLogin").find(".existedTips").show()}if(k=="error"){$(".registLogin").find(".errorInfo").html("注册失败");setTimeout(function(){$(".registLogin").find(".errorInfo").html("")},3000)}waitingPost=false},error:function(){waitingPost=false;goldlogRecord("/mei.2.18","","type=page","H1733419")}})}}function smsLogin(){if($("#bodyDivID").find("#mobileLogin").hasClass("disagree")){return false}else{var b="mobile";var d="login";var a=$("#bodyDivID").find(".mobileLogin").find(".userAccount").val();var c=$("#bodyDivID").find(".mobileLogin").find(".yanzhenma").val();var e="";if(checkAccountAll(b,d)){if(waitingPost){return false}waitingPost=true;$.ajax({type:"post",async:false,url:loginbaseUrl+"/user/toSmsLogin",data:{telphone:a,validationCode:c},success:function(f){var f=f.result;if(f=="success"){Setcookie("glms_uu",a);_closeDialog();location.reload();goldlogRecord("/mei.1.12","CLK","","H1733413")}if(f=="wrongLogin"){$(".mobileLogin").find(".errorInfo").html("非正常登录");setTimeout(function(){$(".mobileLogin").find(".errorInfo").html("")},3000)}if(f=="wrongValiatedCode"){$(".mobileLogin").find(".Pwd_error").html("验证码错误，请重新输入");setTimeout(function(){$(".mobileLogin").find(".Pwd_error").html("")},3000)}if(f=="is_forbidden"){$(".mobileLogin").find(".errorInfo").html("您的账户已被禁用！");setTimeout(function(){$(".mobileLogin").find(".errorInfo").html("")},3000)}if(f=="is_locked"){$(".mobileLogin").find(".errorInfo").html("出于安全考虑，系统已冻结您的账户，请联系客服：400-664-6698");setTimeout(function(){$(".mobileLogin").find(".errorInfo").html("")},3000)}if(f=="error"){$(".mobileLogin").find(".errorInfo").html("登录失败");setTimeout(function(){$(".mobileLogin").find(".errorInfo").html("")},3000)}waitingPost=false},error:function(){waitingPost=false}})}}}function accountLogin(){var a=$("#bodyDivID").find(".account_login").find(".userAccount").val();var h=$("#bodyDivID").find(".account_login").find(".passWord").val();var b=$("#bodyDivID").find(".account_login").find(".yanzheng").val();var d=getCookie("subscripeEventIds");var g=getCookie("cookieSubPhone");var e=$("#isRemenbered").val();var f=$("#bodyDivID").find(".account_login").find(".rdm_img").hasClass("show");var c="";var i="";isCheckCodeShow(a,"0");if($("#is_check_code_show").val()==="1"&&$(".account_login").find(".yanzheng").val()==""){$(".account_login").find(".Rdm_error").text("请输入右图验证码");return false}if(d==undefined||d==null){d=""}if(g==undefined||g==null){g=""}if(!f){b=""}if(checkAccountAll("account","login")){toEncrypt(h);var j=$("#encryptPwd").val();if(waitingPost){return false}waitingPost=true;$.ajax({type:"post",async:false,url:loginbaseUrl+"/user/tologin",data:{userAccount:a,passWord:j,cookieSubPhone:g,cookieSub:d,emailRandom:b,isRemenbered:e},success:function(l){var k=l.result;c=l.callBackUrl;i=l.errorTime;if(k=="success"){var m=l.bindSwitch;if(e=="yes"){Setcookie("glms_uu",a)}else{Setcookie("glms_uu",a)}Setcookie("isLogin","yes",60*60*1000);goldlogRecord("/mei.1.1","","type=page","H1703600");_closeDialog();if(m=="1"){window.location.href=loginbaseUrl+"/personInfo/bindMobile?type=0"}else{location.reload()}}else{if(k=="wrongLogin"){$("#bodyDivID").find(".account_login").find(".loginError").html("非正常登录");setTimeout(function(){$("#bodyDivID").find(".account_login").find(".loginError").html("")},3000);$(".account_login").find(".rdm_imgBox").click()}else{if(k=="is_forbidden"){$("#bodyDivID").find(".account_login").find(".loginError").html("您的账户已被禁用！");setTimeout(function(){$("#bodyDivID").find(".account_login").find(".loginError").html("")},5000);$("#bodyDivID").find(".account_login").find(".rdm_imgBox").click();goldlogRecord("/mei.1.4","","type=page","H1703624")}else{if(k=="is_locked"){$("#bodyDivID").find(".account_login").find(".loginError").html("出于安全考虑，系统已冻结您的账户，请联系客服：400-664-6698");setTimeout(function(){$("#bodyDivID").find(".account_login").find(".loginError").html("")},5000);$("#bodyDivID").find(".account_login").find(".rdm_imgBox").click();goldlogRecord("/mei.1.5","","type=page","H1703625")}else{if(k=="reset_pwd"){goldlogRecord("/mei.1.2","","type=page","H1703622");window.location.href=loginbaseUrl+"/user/resetPasswordNotification"}else{if(k=="warn"){$("#bodyDivID").find(".account_login").find(".loginError").html(l.errorInfo);setTimeout(function(){$("#bodyDivID").find(".account_login").find(".loginError").html("")},5000);$("#bodyDivID").find(".account_login").find(".rdm_imgBox").click()}else{if(k=="lock"){$("#bodyDivID").find(".account_login").find(".loginError").html(l.errorInfo);setTimeout(function(){$("#bodyDivID").find(".account_login").find(".loginError").html("")},5000);$("#bodyDivID").find(".account_login").find(".rdm_imgBox").click()}else{if(k=="wrongValiatedCode"){$("#bodyDivID").find(".account_login").find(".Rdm_error").html("验证码错误");setTimeout(function(){$("#bodyDivID").find(".account_login").find(".Rdm_error").html("")},3000);$("#bodyDivID").find(".account_login").find(".rdm_imgBox").click()}else{$("#bodyDivID").find(".account_login").find(".loginError").html("账户名或密码错误");setTimeout(function(){$("#bodyDivID").find(".account_login").find(".loginError").html("")},3000);$("#bodyDivID").find(".account_login").find(".rdm_imgBox").click()}}}}}}}}waitingPost=false},error:function(){waitingPost=false;goldlogRecord("/mei.1.7","","type=page","H1703627")}})}}function showPromotion(){$.ajax({type:"post",datatype:"json",async:false,url:loginbaseUrl+"/user/toGetPromotion",success:function(a){if(null!=a.promotion){$("#promotion").html(a.promotion);$("#promotion").css("display","block")}if(null!=a.mgmpromotion){$("#mgmpromotion").html(a.mgmpromotion);$("#mgmpromotion").css("display","block")}},error:function(){str_result="fail"}})}function toregistPop(){var a=getCookie("userId");if(null!=a&&typeof(a)!="undefined"){showPopDiv("popmgmregist")}else{showPopDiv("popregist")}baiduSall()}function baiduSall(){var a=document.createElement("script");a.type="text/javascript";a.async=true;a.defer=true;a.src=(("https:"===document.location.protocol)?"https://":"http://")+"q.vlion.cn/j?mp=120102";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}function toAlipayLogin(){var a=document.location.href;a=base64encode(a);goldlogRecord("/mei.1.9","","type=popup","H1703629");window.location.href=loginbaseUrl+"/user/toAlipayLogin?callbackUrl="+a}function toweiboLogin(){var b="";var a=document.location.href;a=base64encode(a);goldlogRecord("/mei.1.8","","type=popup","H1703628");$.ajax({type:"post",datatype:"json",async:false,url:loginbaseUrl+"/user/toSinaWeibo",data:{callbackUrl:a},success:function(c){b=c.result+""}});if(b!==null){location.href=b}}function toWeChatLogin(){var b="";var a=document.location.href;a=base64encode(a);goldlogRecord("/mei.1.10","","type=popup","H1733390");$.ajax({type:"post",datatype:"json",async:false,url:loginbaseUrl+"/user/toWeChatLogin",data:{callbackUrl:a},success:function(c){b=c.result+""}});if(b!==null){location.href=b}}function toTaobaoLogin(){var b="";var a=document.location.href;a=base64encode(a);goldlogRecord("/mei.1.10","","type=page","H1733390");$.ajax({type:"post",datatype:"json",async:false,url:loginbaseUrl+"/user/toTaobaoLogin",data:{callbackUrl:a},success:function(c){b=c.result+""}});if(b!==null){location.href=b}}function closePopUp(){_closeDialog();location.reload()}function toEncrypt(a){$.ajax({type:"post",async:false,url:loginbaseUrl+"/user/encrypt",data:{key:a},success:function(b){$("#encryptPwd").val(b)},error:function(){}})};